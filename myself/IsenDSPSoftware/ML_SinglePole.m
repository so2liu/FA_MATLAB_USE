function ML_SinglePole()
global FirstDelayOutput 
global FirstStageFeedbackValue FirstDelayInput 
global  FirstFeedbackGain RealInputAxis
global FirstOutputImagAxis
global FirstOutputRealAxis newFormNo100 FirstRealPole
global FirstImagPole CompModeSelect100 SeqLengthSet TestSignalType Compute100
global UCPolePlot UnitCircleAxes
%function ML_SinglePole
%
%Opens a GUI affording experimentation with a single-pole IIR. Any value
%for the pole can be set in edit boxes, and various lengths and types of
%test signal may be chosen. The computation may be done automatically,
%step-by-step (showing intermediate computation values) at fast or slow
%rates.
%
% Author: F. W. Isen
% Copyright 2009 by Morgan & Claypool

ftsz1 = 12;
ftsz2 = 12;
scnsize = get(0,'ScreenSize');
pos1 = [0.0025*scnsize(3), 0.06*scnsize(4), 0.995*scnsize(3), 0.89*scnsize(4)];

%==========================================================================
mat0 = ...
         [0         0    0.5625
         0         0    0.6250
         0         0    0.6875
         0         0    0.7500
         0         0    0.8125
         0         0    0.8750
         0         0    0.9375
         0         0    1.0000
         0    0.0625    1.0000
         0    0.1250    1.0000
         0    0.1875    1.0000
         0    0.2500    1.0000
         0    0.3125    1.0000
         0    0.3750    1.0000
         0    0.4375    1.0000
         0    0.5000    1.0000
         0    0.5625    1.0000
         0    0.6250    1.0000
         0    0.6875    1.0000
         0    0.7500    1.0000
         0    0.8125    1.0000
         0    0.8750    1.0000
         0    0.9375    1.0000
         0    1.0000    1.0000
    0.0625    1.0000    1.0000
    0.1250    1.0000    0.9375
    0.1875    1.0000    0.8750
    0.2500    1.0000    0.8125
    0.3125    1.0000    0.7500
    0.3750    1.0000    0.6875
    0.4375    1.0000    0.6250
    0.5000    1.0000    0.5625
    0.5625    1.0000    0.5000
    0.6250    1.0000    0.4375
    0.6875    1.0000    0.3750
    0.7500    1.0000    0.3125
    0.8125    1.0000    0.2500
    0.8750    1.0000    0.1875
    0.9375    1.0000    0.1250
    1.0000    1.0000    0.0625
    1.0000    1.0000         0
    1.0000    0.9375         0
    1.0000    0.8750         0
    1.0000    0.8125         0
    1.0000    0.7500         0
    1.0000    0.6875         0
    1.0000    0.6250         0
    1.0000    0.5625         0
    1.0000    0.5000         0
    1.0000    0.4375         0
    1.0000    0.3750         0
    1.0000    0.3125         0
    1.0000    0.2500         0
    1.0000    0.1875         0
    1.0000    0.1250         0
    1.0000    0.0625         0
    1.0000         0         0
    0.9375         0         0
    0.8750         0         0
    0.8125         0         0
    0.7500         0         0
    0.6875         0         0
    0.6250         0         0
    0.5625         0         0];
mat1 = ...
   [NaN   NaN   NaN   NaN   NaN   NaN     2     2     2     2     2   NaN   NaN   NaN   NaN   NaN
   NaN   NaN   NaN   NaN     2     2     2     2     2     2     2     2     2   NaN   NaN   NaN
   NaN   NaN   NaN     1     1     1     1     2     2     1     1     1     1     2   NaN   NaN
   NaN   NaN     1     2     2     1     2     2     2     2     2     1     2     1     2   NaN
   NaN   NaN     2     2     2     2     2     2     2     2     2     2     2     2     2   NaN
   NaN     2     2     2     2     2     2     2     2     2     2     2     2     2     2     2
   NaN     2     2     1     1     1     1     1     1     1     1     1     1     1     2     2
   NaN     2     1     1     1     1     1     1     1     1     1     1     1     1     1     2
   NaN     2     2     1     1     1     1     1     1     1     1     1     1     1     2     2
   NaN     2     2     2     1     1     1     1     2     1     2     1     1     2     2     2
   NaN   NaN     2     2     2     2     2     1     2     1     2     1     2     2     2   NaN
   NaN   NaN     2     2     2     2     2     1     2     1     2     1     2     2     2   NaN
   NaN   NaN   NaN     2     2     2     2     1     2     1     2     1     2     2   NaN   NaN
   NaN   NaN   NaN   NaN     2     2     2     2     1     1     1     2     2   NaN   NaN   NaN
   NaN   NaN   NaN   NaN   NaN   NaN     2     2     2     2     2   NaN   NaN   NaN   NaN   NaN
   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN];
mat2 = ...
         [0         0    1.0000
         0    0.5000         0
    1.0000         0         0
         0    0.7500    0.7500
    0.7500         0    0.7500
    0.7500    0.7500         0
    0.2500    0.2500    0.2500];
mat3 = ...
  [-50.3041  -50.3110  -50.3315  -50.3657  -50.4134  -50.4745  -50.5488  -50.6362  -50.7364  -50.8491  -50.9740 ...
  -51.1107  -51.2590  -51.4184  -51.5884  -51.7686  -51.9584  -52.1575  -52.3652  -52.5809  -52.8041  -53.0341 ...
  -53.2704  -53.5123  -53.7590  -54.0100  -54.2645  -54.5219  -54.7815  -55.0424  -55.3041  -55.5658  -55.8267 ...
  -56.0863  -56.3437  -56.5982  -56.8492  -57.0959  -57.3378  -57.5741  -57.8041  -58.0273  -58.2430  -58.4507 ...
  -58.6498  -58.8396  -59.0198  -59.1898  -59.3492  -59.4975  -59.6342  -59.7591  -59.8718  -59.9720  -60.0594 ...
  -60.1337  -60.1948  -60.2425  -60.2767  -60.2972  -60.3041  -60.2972  -60.2767  -60.2425  -60.1948  -60.1337 ...
  -60.0594  -59.9720  -59.8718  -59.7591  -59.6342  -59.4975  -59.3492  -59.1898  -59.0198  -58.8396  -58.6498 ...
  -58.4507  -58.2430  -58.0273  -57.8041  -57.5741  -57.3378  -57.0959  -56.8492  -56.5982  -56.3437  -56.0863 ...
  -55.8267  -55.5658  -55.3041  -55.0424  -54.7815  -54.5219  -54.2645  -54.0100  -53.7590  -53.5123  -53.2704 ...
  -53.0341  -52.8041  -52.5809  -52.3652  -52.1575  -51.9584  -51.7686  -51.5884  -51.4184  -51.2590  -51.1107 ...
  -50.9740  -50.8491  -50.7364  -50.6362  -50.5488  -50.4745  -50.4134  -50.3657  -50.3315  -50.3110  -50.3041];

mat4 = ...
   [19.7216   20.1141   20.5055   20.8948   21.2809   21.6627   22.0392   22.4093   22.7721   23.1265   23.4716 ...
   23.8064   24.1300   24.4415   24.7401   25.0249   25.2952   25.5502   25.7892   26.0116   26.2168   26.4041 ...
   26.5732   26.7234   26.8545   26.9660   27.0577   27.1292   27.1805   27.2113   27.2216   27.2113   27.1805 ...
   27.1292   27.0577   26.9660   26.8545   26.7234   26.5732   26.4041   26.2168   26.0116   25.7892   25.5502 ...
   25.2952   25.0249   24.7401   24.4415   24.1300   23.8064   23.4716   23.1265   22.7721   22.4093   22.0392 ...
   21.6627   21.2809   20.8948   20.5055   20.1141   19.7216   19.3291   18.9376   18.5483   18.1622   17.7804 ...
   17.4040   17.0338   16.6711   16.3166   15.9716   15.6368   15.3132   15.0017   14.7031   14.4183   14.1480 ...
   13.8930   13.6540   13.4315   13.2264   13.0390   12.8700   12.7197   12.5887   12.4771   12.3855   12.3139 ...
   12.2627   12.2319   12.2216   12.2319   12.2627   12.3139   12.3855   12.4771   12.5887   12.7197   12.8700 ...
   13.0390   13.2264   13.4315   13.6540   13.8930   14.1480   14.4183   14.7031   15.0017   15.3132   15.6368 ...
   15.9716   16.3166   16.6711   17.0338   17.4040   17.7804   18.1622   18.5483   18.9376   19.3291   19.7216];

mat7 = ...
   [11.8329    4.4084    4.4084  -10.4408];

mat9 = ...
    [9.0829    9.0829   11.8329    9.0829];

mat21 = ...
         [0         0    1.0000
         0    0.5000         0
    1.0000         0         0
         0    0.7500    0.7500
    0.7500         0    0.7500
    0.7500    0.7500         0
    0.2500    0.2500    0.2500];

mat36 = ...
         [0         0    1.0000
         0    0.5000         0
    1.0000         0         0
         0    0.7500    0.7500
    0.7500         0    0.7500
    0.7500    0.7500         0
    0.2500    0.2500    0.2500];

mat38 = ...
         [0         0    1.0000
         0    0.5000         0
    1.0000         0         0
         0    0.7500    0.7500
    0.7500         0    0.7500
    0.7500    0.7500         0
    0.2500    0.2500    0.2500];
%==========================================================================
xTxtOffset = -2;
xoffset = -10;
yoffset = -3;
specxoffset = -25;

newFormNo100 = figure(100);
clf

set(newFormNo100,'Color',[1 1 1], ...
	'Colormap',mat0, ...
	'PointerShapeCData',mat1, ...
	'Position',pos1, ...  % [16 12 768 468], ...
	'DoubleBuffer','on','numbertitle','off','name','Signal Flow in a Single Pole Recursive Filter');
HndnewFormAxis = axes('Parent',newFormNo100, ...
	'CameraUpVector',[0 1 0], ...
	'CameraUpVectorMode','manual', ...
	'Color',[1 1 1], ...
	'ColorOrder',mat2, ...
	'Position',[0.04 0.04 0.92 0.92], ...
	'XColor',[0 0 0], ...
	'XLim',[-100 90], ...
	'XLimMode','manual', ...
	'YColor',[0 0 0], ...
	'YLim',[-100 100], ...
	'YLimMode','manual', ...
	'ZColor',[0 0 0],'visible','off');
line('Parent',HndnewFormAxis, ...
	'Color',[0 0 0], ...
	'XData',[-90 -60 -60 -90 -90]+ xoffset, ...
	'YData',[-20 -20 -10 -10 -20]+yoffset);
line('Parent',HndnewFormAxis, ...
	'Color',[0 0 0], ...
	'XData',[-50 -20 -20 -50 -50]+ xoffset, ...
	'YData',[-20 -20 -10 -10 -20]+yoffset);
line('Parent',HndnewFormAxis, ...
	'Color',[0 0 0], ...
	'XData',[-50 -20 -20 -50 -50]+ xoffset, ...
	'YData',[-10 -10 0 0 -10]+yoffset);
line('Parent',HndnewFormAxis, ...
	'Color',[0 0 0], ...
	'XData',mat3+ xoffset, ...
   'YData',mat4+yoffset);
line('Parent',HndnewFormAxis, ...
	'XData',[-40.01414427157002 -70.01414427157002 -40.01414427157002 -40.01414427157002]+ xoffset, ...
	'YData',[-78.5568445475638 -60.55684454756379 -42.55684454756379 -78.5568445475638]+yoffset);
line('Parent',HndnewFormAxis, ...
	'Color',[0 0 0], ...
	'XData',[-60.3960396039604 -90 -90 -84]+ xoffset, ...
   'YData',[20.18 20.18 65 65]+yoffset);

line('Parent',HndnewFormAxis, ...
	'Color',[0 0 0], ...
	'XData',[8.99575671852898+specxoffset -50.21216407355021]+ xoffset, ...
   'YData',[20.18561484918793 20.18561484918793]+yoffset);

line('Parent',HndnewFormAxis, ...
	'Color',[0 0 0], ...
	'XData',[-35.21923620933524 -35.21923620933524]+ xoffset, ...
	'YData',[-0.2320185614849208 20.18561484918793]+yoffset);
line('Parent',HndnewFormAxis, ...
	'Color',[0 0 0], ...
	'XData',[-35.21923620933524 -35.21923620933524 -40.02828854314003]+ xoffset, ...
	'YData',[-20.64965197215776 -60.09280742459396 -60.09280742459396]+yoffset);
line('Parent',HndnewFormAxis, ...
	'Color',[0 0 0], ...
	'XData',[-69.73125884016974 -75.10608203677509 -75.10608203677509]+ xoffset, ...
	'YData',[-60.55684454756379 -60.55684454756379 -20.18561484918793]+yoffset);
line('Parent',HndnewFormAxis, ...
	'Color',[0 0 0], ...
	'XData',[-55.3041018387553 -55.3041018387553 -75.10608203677509 -75.10608203677509]+ xoffset, ...
	'YData',mat7+yoffset);
patch('Parent',HndnewFormAxis, ...
	'XData',[-56.4041018387553 -54.2041018387553 -55.3041018387553 -56.4041018387553]+ xoffset, ...
	'YData',mat9+yoffset);
patch('Parent',HndnewFormAxis, ......
	'XData',[-76.20608203677509 -74.0060820367751 -75.10608203677509 -76.20608203677509]+ xoffset, ...
	'YData',[-23.39965197215776 -23.39965197215776 -20.64965197215776 -23.39965197215776]+yoffset);

patch('Parent',HndnewFormAxis, ...
	'XData',[-36.32 -34.12 -35.22 -36.32]+ xoffset, ...
	'YData',[2.52 2.5 -0.23 2.52]+yoffset);

patch('Parent',HndnewFormAxis, ...
	'XData',[-37.7 -40.03 -37.73 -37.73]+ xoffset, ...
	'YData',[-61.7 -60.1 -58.48 -61.7]+yoffset);

patch('Parent',HndnewFormAxis, ...
	'XData',[-62.98 -60.68 -62.98 -62.98]+ xoffset, ...
   'YData',[18.57 20.18 21.79 18.57]+yoffset);

patch('Parent',HndnewFormAxis, ...
	'XData',[6.97864214992928 9.27864214992928 6.97864214992928 6.97864214992928]+ specxoffset+xoffset, ...
	'YData',[18.57561484918793 20.18561484918793 21.79561484918793 18.57561484918793]+yoffset);

FirstStageFeedbackValue = text('Parent',HndnewFormAxis, ...
	'Color',[0 0 0], ...
	'Position',[-86.99+xTxtOffset+ xoffset -15.54+yoffset 0], ...
   'String','text?');
FirstDelayInput = text('Parent',HndnewFormAxis, ...
	'Color',[0 0 0], ...
	'Position',[-46.53465346534654+xTxtOffset+ xoffset -5.800464037122964+yoffset 0], ...
	'String','text?');
FirstDelayOutput = text('Parent',HndnewFormAxis, ...
	'Color',[0 0 0], ...
	'Position',[-46.53465346534654+xTxtOffset+ xoffset -15.54524361948955+yoffset 0], ...
   'String','text?');

FirstFeedbackGain = text('Parent',HndnewFormAxis, ...
	'Color',[0 0 0], ...
	'Position',[-60.3960396039604+xTxtOffset+ xoffset -60.09280742459396+yoffset 0], ...
	'String','text?');
text('Parent',HndnewFormAxis, ...
	'Color',[0 0 0], ...
	'Position',[-56.15275813295615+ xoffset 20.64965197215777+yoffset 0], ...
	'String','+','fontsize',12);

text('Parent',HndnewFormAxis, ...
	'Color',[0 0 0], ...
	'Position',[-87.27015558698727+ xoffset 25.5+yoffset 0], ...
	'String','Input (Real)');

RealInputAxis = axes('Parent',newFormNo100, ...
	'CameraUpVector',[0 1 0], ...
	'Color',[1 1 1], ...
	'ColorOrder',mat21, ...
	'Position',[0.1237  0.7050  0.25 0.2], ...
	'XColor',[0 0 0], ...
	'XLim',[0 32],...
	'XLimMode','manual', ...
	'YColor',[0 0 0], ...
	'YLim',[-5 5], ...
	'YLimMode','manual', ...
   'ZColor',[0 0 0]);

FirstOutputImagAxis = axes('Parent',newFormNo100, ...
	'CameraUpVector',[0 1 0], ...
	'Color',[1 1 1], ...
	'ColorOrder',mat36, ...
	'Position',[0.5 0.55 0.45 0.15], ...
	'XColor',[0 0 0], ...
	'XLim',[0 32], ...
	'XLimMode','manual', ...
	'YColor',[0 0 0], ...
   'YLim',[-5 5],... 
   'YLimMode','manual', ...
   'ZColor',[0 0 0]);

FirstOutputRealAxis = axes('Parent',newFormNo100, ...
	'CameraUpVector',[0 1 0], ...
	'Color',[1 1 1], ...
	'ColorOrder',mat38, ...
	'Position',[0.5 0.8 0.45 0.15], ...
	'XColor',[0 0 0], ...
	'XLim',[0 32], ...
	'XLimMode','manual', ...
	'YColor',[0 0 0], ...
   'YLim',[-5 5],... 
   'YLimMode','manual', ...
	'ZColor',[0 0 0]);
%if nargout > 0, 
%    fig = newFormNo100; 
%end

%figure(newFormNo100)

posWin = get(newFormNo100,'Position');

posFirstRealPole = ([0.06*posWin(3)  0.07*posWin(4) 0.15*posWin(3) 0.04*posWin(4)]);
FirstRealPole = uicontrol('Style','edit','Position',posFirstRealPole, ...
   'String','0.9','backgroundcolor',[1 1 1]);
posFirstImagPole = ([0.21*posWin(3)  0.07*posWin(4) 0.15*posWin(3) 0.04*posWin(4)]);
FirstImagPole = uicontrol('Style','edit','Position',posFirstImagPole, ...
   'String','45','backgroundcolor',[1 1 1]);
posRealPoleText = [-87  -98];
posImagPoleText = [-61  -98];
subplot(HndnewFormAxis)
text(posRealPoleText(1),posRealPoleText(2),'Magnitude')
text(posImagPoleText(1),posImagPoleText(2),'Angle(Degrees)')


posCompute100 = ([0.45*posWin(3)  0.38*posWin(4) 0.15*posWin(3) 0.04*posWin(4)]);
Compute100 = uicontrol('Style','push','String','Compute','Position',posCompute100, ...
   'Callback','SinglePoleCompute','backgroundcolor',[1 1 1]);
posSeqLengthSelect = ([0.45*posWin(3)  0.28*posWin(4) 0.15*posWin(3) 0.05*posWin(4)]);
SeqLengthSet = uicontrol('Style','Popup','Position',[posSeqLengthSelect(1) posSeqLengthSelect(2) posSeqLengthSelect(3) posSeqLengthSelect(4)],'String',...
     'Test Seq Len|4|8|16|32|64|128|256|512|1024','backgroundcolor',[1 1 1]); 
posCompModeSelect100 = ([0.45*posWin(3)  0.18*posWin(4) 0.15*posWin(3) 0.05*posWin(4)]);
CompModeSelect100 = uicontrol('Style','Popup','Position',[posCompModeSelect100(1) posCompModeSelect100(2) posCompModeSelect100(3) posCompModeSelect100(4)],'String',...
     'Computation Mode|Auto Fast|Auto Slow|All At Once','backgroundcolor',[1 1 1]); 
posTestSignalSelect = ([0.45*posWin(3)  0.08*posWin(4) 0.15*posWin(3) 0.05*posWin(4)]);
TestSignalType = uicontrol('Style','Popup','Position',[posTestSignalSelect(1) posTestSignalSelect(2) posTestSignalSelect(3) posTestSignalSelect(4)],'String',...
      'Test Signal|Impulse|Unit Step|Chirp','backgroundcolor',[1 1 1]);
   

posUnitCircleAxes = [0.7 0.1 0.24 0.3];
UnitCircleAxes = axes('Position',posUnitCircleAxes);
set(UnitCircleAxes,'XLim',[-1.2  1.2],'YLim',[-1.2 1.2]);
% get(UnitCircleAxes);
ylabel('Imag','fontsize',ftsz2)
xlabel('(d) Real','fontsize',ftsz1)

subplot(UnitCircleAxes)
CirSR = 256;
theta = 0:(2*pi)/CirSR:(2*pi-(2*pi)/CirSR);

xs = cos(theta);
ys = sin(theta);

horlinex = -1.2:0.1:1.2;
vertliney = zeros(length(horlinex));
Vliney = -1.2:0.1:1.2;
Vlinex = zeros(length(Vliney));

hold on
cirplot = plot(xs,ys,'k');
set(cirplot,'linewidth',1)

ThePole = 0.9*(1+j)/sqrt(2);
%plot(real(ThePole),imag(ThePole),'b.')

plot(horlinex,vertliney,'k:','linewidth',1)
plot(Vlinex, Vliney,'k:','linewidth',1)
UCPolePlot = plot(real(ThePole),imag(ThePole),'rx');

set(UCPolePlot,'MarkerSize',10);
hold off 
   